[03/13 11:25:43] detectron2 INFO: Rank of current process: 0. World size: 1
[03/13 11:25:43] detectron2 INFO: Command line arguments: Namespace(config_file='configs/Grocery-detection/faster_rcnn_R101_FPN_ft_all.yaml', resume=False, eval_only=False, eval_all=False, eval_during_train=False, eval_iter=-1, start_iter=-1, end_iter=-1, num_gpus=1, num_machines=1, machine_rank=0, dist_url='tcp://127.0.0.1:49654', opts=['MODEL.WEIGHTS', 'checkpoints/voc/faster_rcnn/faster_rcnn_R_101_FPN_all1/model_reset_surgery.pth', 'MODEL.DEVICE', 'cpu'])
[03/13 11:25:43] detectron2 INFO: Contents of args.config_file=configs/Grocery-detection/faster_rcnn_R101_FPN_ft_all.yaml:
_BASE_: "../Base-RCNN-FPN.yaml"
MODEL:
  WEIGHTS: "checkpoints/voc/faster_rcnn/faster_rcnn_R_101_FPN_base1/model_reset_surgery.pth"
  MASK_ON: False
  RESNETS:
    DEPTH: 101
  ROI_HEADS:
    NUM_CLASSES: 20
    OUTPUT_LAYER: "CosineSimOutputLayers"
    FREEZE_FEAT: True
  BACKBONE:
    FREEZE: True
  PROPOSAL_GENERATOR:
    FREEZE: True
INPUT:
  MIN_SIZE_TRAIN: (480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800)
  MIN_SIZE_TEST: 800
DATASETS:
  TRAIN: ('grocery_all',)   #voc_2007_trainval_all1_1shot_seed1
  TEST: ('grocery_novel',)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.001
  STEPS: (3000,)
  MAX_ITER: 4000
  CHECKPOINT_PERIOD: 500
  WARMUP_ITERS: 0
OUTPUT_DIR: "checkpoints/grocery/faster_rcnn/faster_rcnn_R_101_FPN_ft_normalized_all1_1shot_randnovel"
[03/13 11:25:43] detectron2 INFO: Full config saved to /Users/hariharan/hari_works/grocery-object-detection/ocr/demo/few_shot/few-shot-object-detection/checkpoints/grocery/faster_rcnn/faster_rcnn_R_101_FPN_ft_normalized_all1_1shot_randnovel/config.yaml
[03/13 11:25:43] d2.utils.env INFO: Using a generated random seed 43877606
[03/13 11:38:18] detectron2 INFO: Rank of current process: 0. World size: 1
[03/13 11:38:18] detectron2 INFO: Command line arguments: Namespace(config_file='configs/Grocery-detection/faster_rcnn_R101_FPN_ft_all.yaml', resume=False, eval_only=False, eval_all=False, eval_during_train=False, eval_iter=-1, start_iter=-1, end_iter=-1, num_gpus=1, num_machines=1, machine_rank=0, dist_url='tcp://127.0.0.1:49654', opts=['MODEL.WEIGHTS', 'checkpoints/voc/faster_rcnn/faster_rcnn_R_101_FPN_all1/model_reset_surgery.pth', 'MODEL.DEVICE', 'cpu'])
[03/13 11:38:18] detectron2 INFO: Contents of args.config_file=configs/Grocery-detection/faster_rcnn_R101_FPN_ft_all.yaml:
_BASE_: "../Base-RCNN-FPN.yaml"
MODEL:
  WEIGHTS: "checkpoints/voc/faster_rcnn/faster_rcnn_R_101_FPN_base1/model_reset_surgery.pth"
  MASK_ON: False
  RESNETS:
    DEPTH: 101
  ROI_HEADS:
    NUM_CLASSES: 20
    OUTPUT_LAYER: "CosineSimOutputLayers"
    FREEZE_FEAT: True
  BACKBONE:
    FREEZE: True
  PROPOSAL_GENERATOR:
    FREEZE: True
INPUT:
  MIN_SIZE_TRAIN: (480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800)
  MIN_SIZE_TEST: 800
DATASETS:
  TRAIN: ('grocery_all',)   #voc_2007_trainval_all1_1shot_seed1
  TEST: ('grocery_novel',)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.001
  STEPS: (3000,)
  MAX_ITER: 4000
  CHECKPOINT_PERIOD: 500
  WARMUP_ITERS: 0
OUTPUT_DIR: "checkpoints/grocery/faster_rcnn/faster_rcnn_R_101_FPN_ft_normalized_all1_1shot_randnovel"
[03/13 11:38:18] detectron2 INFO: Full config saved to /Users/hariharan/hari_works/grocery-object-detection/ocr/demo/few_shot/few-shot-object-detection/checkpoints/grocery/faster_rcnn/faster_rcnn_R_101_FPN_ft_normalized_all1_1shot_randnovel/config.yaml
[03/13 11:38:18] d2.utils.env INFO: Using a generated random seed 18320373
[03/13 11:47:06] detectron2 INFO: Rank of current process: 0. World size: 1
[03/13 11:47:06] detectron2 INFO: Command line arguments: Namespace(config_file='configs/Grocery-detection/faster_rcnn_R101_FPN_ft_all.yaml', resume=False, eval_only=False, eval_all=False, eval_during_train=False, eval_iter=-1, start_iter=-1, end_iter=-1, num_gpus=1, num_machines=1, machine_rank=0, dist_url='tcp://127.0.0.1:49654', opts=['MODEL.WEIGHTS', 'checkpoints/voc/faster_rcnn/faster_rcnn_R_101_FPN_all1/model_reset_surgery.pth', 'MODEL.DEVICE', 'cpu'])
[03/13 11:47:06] detectron2 INFO: Contents of args.config_file=configs/Grocery-detection/faster_rcnn_R101_FPN_ft_all.yaml:
_BASE_: "../Base-RCNN-FPN.yaml"
MODEL:
  WEIGHTS: "checkpoints/voc/faster_rcnn/faster_rcnn_R_101_FPN_base1/model_reset_surgery.pth"
  MASK_ON: False
  RESNETS:
    DEPTH: 101
  ROI_HEADS:
    NUM_CLASSES: 20
    OUTPUT_LAYER: "CosineSimOutputLayers"
    FREEZE_FEAT: True
  BACKBONE:
    FREEZE: True
  PROPOSAL_GENERATOR:
    FREEZE: True
INPUT:
  MIN_SIZE_TRAIN: (480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800)
  MIN_SIZE_TEST: 800
DATASETS:
  TRAIN: ('grocery_all',)   #voc_2007_trainval_all1_1shot_seed1
  TEST: ('grocery_novel',)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.001
  STEPS: (3000,)
  MAX_ITER: 4000
  CHECKPOINT_PERIOD: 500
  WARMUP_ITERS: 0
OUTPUT_DIR: "checkpoints/grocery/faster_rcnn/faster_rcnn_R_101_FPN_ft_normalized_all1_1shot_randnovel"
[03/13 11:47:06] detectron2 INFO: Full config saved to /Users/hariharan/hari_works/grocery-object-detection/ocr/demo/few_shot/few-shot-object-detection/checkpoints/grocery/faster_rcnn/faster_rcnn_R_101_FPN_ft_normalized_all1_1shot_randnovel/config.yaml
[03/13 11:47:06] d2.utils.env INFO: Using a generated random seed 6556899
[03/13 11:47:37] detectron2 INFO: Rank of current process: 0. World size: 1
[03/13 11:47:37] detectron2 INFO: Command line arguments: Namespace(config_file='configs/Grocery-detection/faster_rcnn_R101_FPN_ft_all.yaml', resume=False, eval_only=False, eval_all=False, eval_during_train=False, eval_iter=-1, start_iter=-1, end_iter=-1, num_gpus=1, num_machines=1, machine_rank=0, dist_url='tcp://127.0.0.1:49654', opts=['MODEL.WEIGHTS', 'checkpoints/voc/faster_rcnn/faster_rcnn_R_101_FPN_all1/model_reset_surgery.pth', 'MODEL.DEVICE', 'cpu'])
[03/13 11:47:37] detectron2 INFO: Contents of args.config_file=configs/Grocery-detection/faster_rcnn_R101_FPN_ft_all.yaml:
_BASE_: "../Base-RCNN-FPN.yaml"
MODEL:
  WEIGHTS: "checkpoints/voc/faster_rcnn/faster_rcnn_R_101_FPN_base1/model_reset_surgery.pth"
  MASK_ON: False
  RESNETS:
    DEPTH: 101
  ROI_HEADS:
    NUM_CLASSES: 20
    OUTPUT_LAYER: "CosineSimOutputLayers"
    FREEZE_FEAT: True
  BACKBONE:
    FREEZE: True
  PROPOSAL_GENERATOR:
    FREEZE: True
INPUT:
  MIN_SIZE_TRAIN: (480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800)
  MIN_SIZE_TEST: 800
DATASETS:
  TRAIN: ('grocery_all',)   #voc_2007_trainval_all1_1shot_seed1
  TEST: ('grocery_novel',)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.001
  STEPS: (3000,)
  MAX_ITER: 4000
  CHECKPOINT_PERIOD: 500
  WARMUP_ITERS: 0
OUTPUT_DIR: "checkpoints/grocery/faster_rcnn/faster_rcnn_R_101_FPN_ft_normalized_all1_1shot_randnovel"
[03/13 11:47:37] detectron2 INFO: Full config saved to /Users/hariharan/hari_works/grocery-object-detection/ocr/demo/few_shot/few-shot-object-detection/checkpoints/grocery/faster_rcnn/faster_rcnn_R_101_FPN_ft_normalized_all1_1shot_randnovel/config.yaml
[03/13 11:47:37] d2.utils.env INFO: Using a generated random seed 37511138
[03/13 11:47:38] d2.data.build INFO: Removed 0 images with no usable annotations. 12 images left.
[03/13 11:47:38] d2.data.build INFO: Distribution of instances among all 4 categories:
[36m|   category    | #instances   |   category   | #instances   |  category  | #instances   |
|:-------------:|:-------------|:------------:|:-------------|:----------:|:-------------|
| 3roses_top_.. | 6            | dettol_250ml | 2            | hamam_100g | 2            |
| nescafe_cla.. | 2            |              |              |            |              |
|     total     | 12           |              |              |            |              |[0m
[03/13 11:47:38] d2.data.dataset_mapper INFO: [DatasetMapper] Augmentations used in training: [ResizeShortestEdge(short_edge_length=(480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800), max_size=1333, sample_style='choice'), RandomFlip()]
[03/13 11:47:38] d2.data.build INFO: Using training sampler TrainingSampler
[03/13 11:47:38] d2.data.common INFO: Serializing 12 elements to byte tensors and concatenating them all ...
[03/13 11:47:38] d2.data.common INFO: Serialized dataset takes 0.00 MiB
[03/13 11:47:47] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/voc/faster_rcnn/faster_rcnn_R_101_FPN_all1/model_reset_surgery.pth ...
[03/13 11:47:47] d2.engine.train_loop INFO: Starting training from iteration 0
[03/13 11:47:53] d2.engine.train_loop ERROR: Exception during training:
Traceback (most recent call last):
  File "/Users/hariharan/hari_works/virtualenv/lib/python3.9/site-packages/detectron2/engine/train_loop.py", line 149, in train
    self.run_step()
  File "/Users/hariharan/hari_works/virtualenv/lib/python3.9/site-packages/detectron2/engine/train_loop.py", line 267, in run_step
    data = next(self._data_loader_iter)
  File "/Users/hariharan/hari_works/virtualenv/lib/python3.9/site-packages/detectron2/data/common.py", line 234, in __iter__
    for d in self.dataset:
  File "/Users/hariharan/hari_works/virtualenv/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 521, in __next__
    data = self._next_data()
  File "/Users/hariharan/hari_works/virtualenv/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1203, in _next_data
    return self._process_data(data)
  File "/Users/hariharan/hari_works/virtualenv/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1229, in _process_data
    data.reraise()
  File "/Users/hariharan/hari_works/virtualenv/lib/python3.9/site-packages/torch/_utils.py", line 434, in reraise
    raise exception
detectron2.data.detection_utils.SizeMismatchError: Caught SizeMismatchError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/Users/hariharan/hari_works/virtualenv/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 287, in _worker_loop
    data = fetcher.fetch(index)
  File "/Users/hariharan/hari_works/virtualenv/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 32, in fetch
    data.append(next(self.dataset_iter))
  File "/Users/hariharan/hari_works/virtualenv/lib/python3.9/site-packages/detectron2/data/common.py", line 201, in __iter__
    yield self.dataset[idx]
  File "/Users/hariharan/hari_works/virtualenv/lib/python3.9/site-packages/detectron2/data/common.py", line 90, in __getitem__
    data = self._map_func(self._dataset[cur_idx])
  File "/Users/hariharan/hari_works/virtualenv/lib/python3.9/site-packages/detectron2/data/dataset_mapper.py", line 155, in __call__
    utils.check_image_size(dataset_dict, image)
  File "/Users/hariharan/hari_works/virtualenv/lib/python3.9/site-packages/detectron2/data/detection_utils.py", line 196, in check_image_size
    raise SizeMismatchError(
detectron2.data.detection_utils.SizeMismatchError: Mismatched image shape for image /Users/hariharan/Downloads/grocery-db/3roses_top_star/IMG_20220214_161836.jpg, got (3456, 4608), expect (4608.0, 3456.0). Please check the width/height in your annotation.

[03/13 11:47:53] d2.engine.hooks INFO: Total training time: 0:00:06 (0:00:00 on hooks)
[03/13 11:47:53] d2.utils.events INFO:  iter: 0    lr: N/A  
[03/13 12:14:13] detectron2 INFO: Rank of current process: 0. World size: 1
[03/13 12:14:13] detectron2 INFO: Command line arguments: Namespace(config_file='configs/Grocery-detection/faster_rcnn_R101_FPN_ft_all.yaml', resume=False, eval_only=False, eval_all=False, eval_during_train=False, eval_iter=-1, start_iter=-1, end_iter=-1, num_gpus=1, num_machines=1, machine_rank=0, dist_url='tcp://127.0.0.1:49654', opts=['MODEL.WEIGHTS', 'checkpoints/voc/faster_rcnn/faster_rcnn_R_101_FPN_all1/model_reset_surgery.pth', 'MODEL.DEVICE', 'cpu'])
[03/13 12:14:13] detectron2 INFO: Contents of args.config_file=configs/Grocery-detection/faster_rcnn_R101_FPN_ft_all.yaml:
_BASE_: "../Base-RCNN-FPN.yaml"
MODEL:
  WEIGHTS: "checkpoints/voc/faster_rcnn/faster_rcnn_R_101_FPN_base1/model_reset_surgery.pth"
  MASK_ON: False
  RESNETS:
    DEPTH: 101
  ROI_HEADS:
    NUM_CLASSES: 20
    OUTPUT_LAYER: "CosineSimOutputLayers"
    FREEZE_FEAT: True
  BACKBONE:
    FREEZE: True
  PROPOSAL_GENERATOR:
    FREEZE: True
INPUT:
  MIN_SIZE_TRAIN: (480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800)
  MIN_SIZE_TEST: 800
DATASETS:
  TRAIN: ('grocery_all',)   #voc_2007_trainval_all1_1shot_seed1
  TEST: ('grocery_novel',)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.001
  STEPS: (3000,)
  MAX_ITER: 4000
  CHECKPOINT_PERIOD: 500
  WARMUP_ITERS: 0
OUTPUT_DIR: "checkpoints/grocery/faster_rcnn/faster_rcnn_R_101_FPN_ft_normalized_all1_1shot_randnovel"
[03/13 12:14:13] detectron2 INFO: Full config saved to /Users/hariharan/hari_works/grocery-object-detection/ocr/demo/few_shot/few-shot-object-detection/checkpoints/grocery/faster_rcnn/faster_rcnn_R_101_FPN_ft_normalized_all1_1shot_randnovel/config.yaml
[03/13 12:14:13] d2.utils.env INFO: Using a generated random seed 13532898
[03/13 12:14:14] d2.data.build INFO: Removed 0 images with no usable annotations. 12 images left.
[03/13 12:14:14] d2.data.build INFO: Distribution of instances among all 4 categories:
[36m|   category    | #instances   |   category   | #instances   |  category  | #instances   |
|:-------------:|:-------------|:------------:|:-------------|:----------:|:-------------|
| 3roses_top_.. | 6            | dettol_250ml | 2            | hamam_100g | 2            |
| nescafe_cla.. | 2            |              |              |            |              |
|     total     | 12           |              |              |            |              |[0m
[03/13 12:14:14] d2.data.dataset_mapper INFO: [DatasetMapper] Augmentations used in training: [ResizeShortestEdge(short_edge_length=(480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800), max_size=1333, sample_style='choice'), RandomFlip()]
[03/13 12:14:14] d2.data.build INFO: Using training sampler TrainingSampler
[03/13 12:14:14] d2.data.common INFO: Serializing 12 elements to byte tensors and concatenating them all ...
[03/13 12:14:14] d2.data.common INFO: Serialized dataset takes 0.00 MiB
[03/13 12:14:21] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/voc/faster_rcnn/faster_rcnn_R_101_FPN_all1/model_reset_surgery.pth ...
[03/13 12:14:21] d2.engine.train_loop INFO: Starting training from iteration 0
[03/13 12:15:08] d2.engine.hooks INFO: Total training time: 0:00:46 (0:00:00 on hooks)
[03/13 12:15:08] d2.utils.events INFO:  iter: 0    lr: N/A  
